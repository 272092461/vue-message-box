(function(t){function e(e){for(var a,o,s=e[0],c=e[1],l=e[2],d=0,p=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(p.length)p.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(a=!1)}a&&(r.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},i={app:0},r=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"0263":function(t,e,n){"use strict";var a=n("0cc5"),i=n.n(a);i.a},"0cc5":function(t,e,n){},"27d7":function(t,e,n){"use strict";var a=n("4fd9"),i=n.n(a);i.a},3468:function(t,e,n){},"4fd9":function(t,e,n){},"8aaa":function(t,e,n){"use strict";var a=n("3468"),i=n.n(a);i.a},"8dae":function(t,e,n){t.exports=n.p+"img/shin.cdac5021.jpg"},c022:function(t,e,n){"use strict";var a=n("e526"),i=n.n(a);i.a},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("MessageBox",{ref:"messageBox",attrs:{data:t.messages,contactAvatarUrl:t.contactAvatarUrl,ownerAvatarUrl:t.ownerAvatarUrl,loading:t.loading},on:{nextPage:t.nextPageHandle}})],1)},r=[],o=(n("99af"),n("d3b7"),n("96cf"),n("1da1")),s=n("d4ec"),c=n("bee2"),l=n("99de"),u=n("7e84"),d=n("262e"),p=n("9ab4"),h=n("60a3"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"content",staticClass:"box-wrap"},t._l(t.viewMessages,(function(e){return n("div",{key:e.id,ref:"messageDoms",refInFor:!0},[n("MessageLine",{attrs:{message:e,contactAvatarUrl:t.contactAvatarUrl,ownerAvatarUrl:t.ownerAvatarUrl}},[3!==e.direction?n("UserMessage",{attrs:{type:e.type,content:e.content}}):n("CommonMessage",{attrs:{content:e.content}})],1)],1)})),0)},v=[],g=(n("fb6a"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return 2===t.message.direction?n("div",{staticClass:"line-wrap"},[n("div",{staticClass:"owner-line"},[n("span",{staticClass:"owner-text"},[t._t("default")],2),n("span",[n("img",{staticClass:"message-avatar",attrs:{src:t.ownerAvatarUrl,alt:""}})])])]):1===t.message.direction?n("div",{staticClass:"line-wrap"},[n("div",{staticClass:"contact-line"},[n("span",[n("img",{staticClass:"message-avatar",attrs:{src:t.contactAvatarUrl,alt:""}})]),n("span",{staticClass:"text"},[t._t("default")],2)])]):3===t.message.direction?n("div",{staticClass:"line-wrap"},[t._t("default")],2):t._e()}),m=[],b=function(t){function e(){return Object(s["a"])(this,e),Object(l["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(d["a"])(e,t),e}(h["c"]);p["a"]([Object(h["b"])()],b.prototype,"message",void 0),p["a"]([Object(h["b"])()],b.prototype,"contactAvatarUrl",void 0),p["a"]([Object(h["b"])()],b.prototype,"ownerAvatarUrl",void 0),b=p["a"]([h["a"]],b);var y=b,j=y,O=(n("27d7"),n("2877")),w=Object(O["a"])(j,g,m,!1,null,"ebde2ab8",null),x=w.exports,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return 1===t.type?n("div",[t._v(" "+t._s(t.content)+" ")]):2===t.type?n("div",{staticClass:"clear-line-size"},[n("img",{staticClass:"user-image",attrs:{src:t.content,alt:""}})]):t._e()},k=[],_=function(t){function e(){return Object(s["a"])(this,e),Object(l["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(d["a"])(e,t),e}(h["c"]);p["a"]([Object(h["b"])()],_.prototype,"type",void 0),p["a"]([Object(h["b"])()],_.prototype,"content",void 0),_=p["a"]([h["a"]],_);var S=_,T=S,H=(n("0263"),Object(O["a"])(T,D,k,!1,null,"10cde85a",null)),U=H.exports,A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"message-wrap"},[n("span",[t._v(t._s(t.content))])])},M=[],C=function(t){function e(){return Object(s["a"])(this,e),Object(l["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(d["a"])(e,t),e}(h["c"]);p["a"]([Object(h["b"])()],C.prototype,"content",void 0),C=p["a"]([h["a"]],C);var L=C,$=L,P=(n("c022"),Object(O["a"])($,A,M,!1,null,"454c96f5",null)),z=P.exports,E=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(l["a"])(this,Object(u["a"])(e).call(this)),t.loading=!1,t.finished=!1,t.size=0,t.oldScrollHeight=0,t.pending=!1,t.size=10,t}return Object(d["a"])(e,t),Object(c["a"])(e,[{key:"mounted",value:function(){var t=this;this.$nextTick((function(){t.initScrollDom(),t.initEvent(t.scrollDom)}))}},{key:"destroyed",value:function(){this.removeEvent(this.scrollDom)}},{key:"onScrollTop",value:function(){var t=this,e=this.loading,n=this.finished,a=this.data,i=this.size,r=this.pending;e||n||r||(this.pending=!0,this.oldScrollHeight=this.scrollDom.scrollHeight,i>a.length?this.$emit("nextPage"):(this.size=i+10,this.$nextTick((function(){t.pending=!1,t.scrollTo(t.scrollDom.scrollHeight-t.oldScrollHeight)}))))}},{key:"onScrollBottom",value:function(){var t=this,e=this.loading,n=this.finished,a=this.size,i=this.pending;this.messageDoms[this.messageDoms.length-1];e||n||i||(this.pending=!0,a>150?this.size=a-50:a>100&&(this.size=100),setTimeout((function(){return t.pending=!1}),100))}},{key:"scrollTo",value:function(t){this.scrollDom.scrollTop=t}},{key:"scrollToTop",value:function(){var t=this;this.$nextTick((function(){t.scrollTo(t.scrollDom.scrollHeight-t.oldScrollHeight),t.pending=!1}))}},{key:"scrollBottom",value:function(){this.size=10,this.scrollTo(this.scrollDom.scrollHeight-this.scrollDom.clientHeight)}},{key:"initScrollDom",value:function(){var t=this;this.scrollDom=this.$refs.content,this.messageDoms=this.$refs.messageDoms,setTimeout((function(){return t.scrollBottom()}),200)}},{key:"initEvent",value:function(t){t.addEventListener("scroll",this.scrollHander)}},{key:"removeEvent",value:function(t){t.removeEventListener("scroll",this.scrollHander)}},{key:"scrollHander",value:function(){var t=this.loading,e=this.finished,n=this.pending;if(!(t||e||n)){var a=this.scrollDom.scrollTop;this.scrollDom.scrollHeight,this.scrollDom.offsetHeight;a<5&&this.onScrollTop()}}},{key:"viewMessages",get:function(){var t=this.size>this.data.length?this.data.length:this.size,e=this.data.slice(this.data.length-t,this.data.length);return e}}]),e}(h["c"]);p["a"]([Object(h["b"])()],E.prototype,"data",void 0),p["a"]([Object(h["b"])()],E.prototype,"loading",void 0),p["a"]([Object(h["b"])()],E.prototype,"finished",void 0),p["a"]([Object(h["b"])()],E.prototype,"ownerAvatarUrl",void 0),p["a"]([Object(h["b"])()],E.prototype,"contactAvatarUrl",void 0),p["a"]([Object(h["b"])()],E.prototype,"width",void 0),p["a"]([Object(h["b"])()],E.prototype,"height",void 0),E=p["a"]([Object(h["a"])({components:{MessageLine:x,UserMessage:U,CommonMessage:z}})],E);var B=E,R=B,J=(n("ec0e"),Object(O["a"])(R,f,v,!1,null,"419e285c",null)),N=J.exports,F=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(l["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.messages=[{direction:2,id:1,type:1,content:"你好!![呲牙]",ctime:(new Date).toLocaleString()},{direction:1,id:2,type:1,content:"你也好。[害羞]",ctime:(new Date).toLocaleString()},{direction:2,id:2,type:1,content:"2333",ctime:(new Date).toLocaleString()},{direction:2,id:2,type:2,content:n("8dae"),ctime:(new Date).toLocaleString()},{direction:3,id:2,type:1,content:"你撤回一条消息",ctime:(new Date).toLocaleString()}],t.contactAvatarUrl=n("e94e"),t.contactNickname="",t.ownerAvatarUrl=n("8dae"),t.ownerNickname="",t.loading=!1,t}return Object(d["a"])(e,t),Object(c["a"])(e,[{key:"mounted",value:function(){for(var t=0;t<100;t++)this.messages.push({direction:t%2+1,id:2,type:1,content:"2333",ctime:(new Date).toLocaleString()},{direction:3,id:2,type:1,content:"你撤回一条消息",ctime:(new Date).toLocaleString()});this.messages.push({direction:1,id:2,type:2,content:n("8dae"),ctime:(new Date).toLocaleString()})}},{key:"nextPageHandle",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,this.getHistoryMessage(0,0);case 3:e=t.sent,this.messages=e.concat(this.messages),this.loading=!1,n=this.$refs.messageBox,n.scrollToTop();case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getHistoryMessage",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve([{direction:1,id:3,type:2,content:n("8dae"),ctime:(new Date).toLocaleString()},{direction:2,id:3,type:1,content:"你好",ctime:(new Date).toLocaleString()}]));case 1:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()}]),e}(h["c"]);F=p["a"]([Object(h["a"])({components:{MessageBox:N}})],F);var I=F,q=I,G=(n("8aaa"),Object(O["a"])(q,i,r,!1,null,null,null)),K=G.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(K)}}).$mount("#app")},de90:function(t,e,n){},e526:function(t,e,n){},e94e:function(t,e,n){t.exports=n.p+"img/avatar.93ba2aeb.jpeg"},ec0e:function(t,e,n){"use strict";var a=n("de90"),i=n.n(a);i.a}});
//# sourceMappingURL=app.d08511cc.js.map